2025-07-01 15:27:44,094 - INFO - Logging initialized successfully
2025-07-01 15:27:52,710 - INFO - Original data loaded with shape: (5179, 2)
2025-07-01 15:27:53,013 - INFO - Removed 456 duplicate titles
2025-07-01 15:27:53,015 - INFO - Removed 456 titles shorter than 5 characters
2025-07-01 15:27:53,017 - INFO - Industry labels checked and stripped
2025-07-01 15:27:53,019 - INFO - Class distribution before balancing: {0: 1279, 1: 744, 2: 607, 3: 1035, 4: 1058}
2025-07-01 15:27:53,019 - WARNING - Significant class imbalance detected!
2025-07-01 15:27:53,027 - INFO - Class distribution after balancing: {0: 607, 1: 607, 2: 607, 3: 607, 4: 607}
2025-07-01 15:27:55,121 - INFO - Tokenization completed with max_length=120
2025-07-01 15:27:55,799 - INFO - Saved processed data with shape: (3035, 4)
2025-07-01 15:27:55,803 - INFO - Title length stats: Min=17, Max=194, Mean=69.40
2025-07-01 15:27:55,803 - INFO - Token length stats: Min=120, Max=120, Mean=120.00
2025-07-01 15:27:55,803 - INFO - Processing config: max_len=120, epochs=10, batch_size=16
2025-07-01 15:27:55,806 - INFO - Data split: Train+Val=2428, Test=607
2025-07-01 15:28:42,274 - INFO - Fold 1, Epoch 1/10 - Train Loss: 1.2981, Train Acc: 0.5546, Val Loss: 0.7945, Val Acc: 0.7840
2025-07-01 15:28:43,156 - INFO - Saved best model at fold 1, epoch 1 with accuracy 0.7840
2025-07-01 15:29:27,773 - INFO - Fold 1, Epoch 2/10 - Train Loss: 0.7136, Train Acc: 0.7884, Val Loss: 0.6584, Val Acc: 0.7984
2025-07-01 15:29:29,213 - INFO - Saved best model at fold 1, epoch 2 with accuracy 0.7984
2025-07-01 15:30:14,316 - INFO - Fold 1, Epoch 3/10 - Train Loss: 0.5102, Train Acc: 0.8491, Val Loss: 0.6817, Val Acc: 0.7942
2025-07-01 15:30:59,156 - INFO - Fold 1, Epoch 4/10 - Train Loss: 0.4108, Train Acc: 0.8826, Val Loss: 0.7185, Val Acc: 0.7881
2025-07-01 15:31:44,013 - INFO - Fold 1, Epoch 5/10 - Train Loss: 0.3340, Train Acc: 0.9099, Val Loss: 0.7863, Val Acc: 0.7881
2025-07-01 15:32:28,958 - INFO - Fold 1, Epoch 6/10 - Train Loss: 0.2565, Train Acc: 0.9408, Val Loss: 0.8276, Val Acc: 0.8025
2025-07-01 15:32:30,414 - INFO - Saved best model at fold 1, epoch 6 with accuracy 0.8025
2025-07-01 15:33:15,310 - INFO - Fold 1, Epoch 7/10 - Train Loss: 0.2240, Train Acc: 0.9475, Val Loss: 0.8619, Val Acc: 0.7942
2025-07-01 15:34:00,336 - INFO - Fold 1, Epoch 8/10 - Train Loss: 0.2040, Train Acc: 0.9516, Val Loss: 0.8754, Val Acc: 0.7901
2025-07-01 15:34:45,214 - INFO - Fold 1, Epoch 9/10 - Train Loss: 0.1785, Train Acc: 0.9588, Val Loss: 0.9060, Val Acc: 0.7901
2025-07-01 15:35:30,164 - INFO - Fold 1, Epoch 10/10 - Train Loss: 0.1528, Train Acc: 0.9665, Val Loss: 0.9002, Val Acc: 0.7942
2025-07-01 15:36:16,160 - INFO - Fold 2, Epoch 1/10 - Train Loss: 1.2553, Train Acc: 0.5711, Val Loss: 0.7797, Val Acc: 0.7634
2025-07-01 15:37:01,206 - INFO - Fold 2, Epoch 2/10 - Train Loss: 0.7028, Train Acc: 0.7904, Val Loss: 0.6352, Val Acc: 0.7942
2025-07-01 15:37:46,194 - INFO - Fold 2, Epoch 3/10 - Train Loss: 0.5590, Train Acc: 0.8383, Val Loss: 0.6071, Val Acc: 0.8025
2025-07-01 15:38:31,203 - INFO - Fold 2, Epoch 4/10 - Train Loss: 0.4520, Train Acc: 0.8682, Val Loss: 0.6015, Val Acc: 0.8107
2025-07-01 15:38:32,699 - INFO - Saved best model at fold 2, epoch 4 with accuracy 0.8107
2025-07-01 15:39:17,721 - INFO - Fold 2, Epoch 5/10 - Train Loss: 0.3772, Train Acc: 0.8986, Val Loss: 0.6622, Val Acc: 0.8045
2025-07-01 15:40:02,701 - INFO - Fold 2, Epoch 6/10 - Train Loss: 0.3201, Train Acc: 0.9145, Val Loss: 0.6594, Val Acc: 0.8045
2025-07-01 15:40:47,482 - INFO - Fold 2, Epoch 7/10 - Train Loss: 0.2540, Train Acc: 0.9387, Val Loss: 0.6807, Val Acc: 0.8066
2025-07-01 15:41:32,462 - INFO - Fold 2, Epoch 8/10 - Train Loss: 0.2174, Train Acc: 0.9464, Val Loss: 0.7097, Val Acc: 0.8066
2025-07-01 15:42:17,480 - INFO - Fold 2, Epoch 9/10 - Train Loss: 0.1928, Train Acc: 0.9542, Val Loss: 0.7183, Val Acc: 0.8128
2025-07-01 15:42:18,946 - INFO - Saved best model at fold 2, epoch 9 with accuracy 0.8128
2025-07-01 15:43:03,890 - INFO - Fold 2, Epoch 10/10 - Train Loss: 0.1933, Train Acc: 0.9552, Val Loss: 0.7361, Val Acc: 0.8148
2025-07-01 15:43:05,367 - INFO - Saved best model at fold 2, epoch 10 with accuracy 0.8148
2025-07-01 15:43:51,506 - INFO - Fold 3, Epoch 1/10 - Train Loss: 1.2395, Train Acc: 0.5536, Val Loss: 0.7588, Val Acc: 0.7860
2025-07-01 15:44:36,341 - INFO - Fold 3, Epoch 2/10 - Train Loss: 0.6448, Train Acc: 0.8079, Val Loss: 0.6764, Val Acc: 0.7798
2025-07-01 15:45:21,312 - INFO - Fold 3, Epoch 3/10 - Train Loss: 0.5176, Train Acc: 0.8491, Val Loss: 0.6629, Val Acc: 0.7901
2025-07-01 15:46:06,350 - INFO - Fold 3, Epoch 4/10 - Train Loss: 0.4016, Train Acc: 0.8877, Val Loss: 0.7153, Val Acc: 0.7881
2025-07-01 15:46:51,363 - INFO - Fold 3, Epoch 5/10 - Train Loss: 0.3482, Train Acc: 0.9011, Val Loss: 0.7610, Val Acc: 0.7984
2025-07-01 15:47:36,347 - INFO - Fold 3, Epoch 6/10 - Train Loss: 0.2834, Train Acc: 0.9300, Val Loss: 0.7970, Val Acc: 0.7942
2025-07-01 15:48:21,316 - INFO - Fold 3, Epoch 7/10 - Train Loss: 0.2469, Train Acc: 0.9387, Val Loss: 0.8554, Val Acc: 0.7922
2025-07-01 15:49:06,237 - INFO - Fold 3, Epoch 8/10 - Train Loss: 0.2114, Train Acc: 0.9495, Val Loss: 0.9037, Val Acc: 0.7922
2025-07-01 15:49:51,159 - INFO - Fold 3, Epoch 9/10 - Train Loss: 0.1975, Train Acc: 0.9531, Val Loss: 0.9019, Val Acc: 0.7942
2025-07-01 15:50:36,077 - INFO - Fold 3, Epoch 10/10 - Train Loss: 0.1853, Train Acc: 0.9573, Val Loss: 0.9212, Val Acc: 0.7922
2025-07-01 15:51:22,161 - INFO - Fold 4, Epoch 1/10 - Train Loss: 1.4220, Train Acc: 0.4678, Val Loss: 0.9241, Val Acc: 0.7567
2025-07-01 15:52:07,208 - INFO - Fold 4, Epoch 2/10 - Train Loss: 0.7452, Train Acc: 0.7921, Val Loss: 0.6864, Val Acc: 0.8000
2025-07-01 15:52:52,151 - INFO - Fold 4, Epoch 3/10 - Train Loss: 0.5577, Train Acc: 0.8307, Val Loss: 0.6812, Val Acc: 0.8082
2025-07-01 15:53:37,061 - INFO - Fold 4, Epoch 4/10 - Train Loss: 0.4394, Train Acc: 0.8703, Val Loss: 0.6938, Val Acc: 0.8103
2025-07-01 15:54:22,024 - INFO - Fold 4, Epoch 5/10 - Train Loss: 0.3460, Train Acc: 0.9048, Val Loss: 0.7079, Val Acc: 0.8103
2025-07-01 15:55:06,991 - INFO - Fold 4, Epoch 6/10 - Train Loss: 0.2924, Train Acc: 0.9228, Val Loss: 0.7644, Val Acc: 0.7918
2025-07-01 15:55:51,912 - INFO - Fold 4, Epoch 7/10 - Train Loss: 0.2447, Train Acc: 0.9367, Val Loss: 0.7657, Val Acc: 0.8000
2025-07-01 15:56:36,830 - INFO - Fold 4, Epoch 8/10 - Train Loss: 0.2001, Train Acc: 0.9506, Val Loss: 0.8746, Val Acc: 0.7897
2025-07-01 15:57:21,786 - INFO - Fold 4, Epoch 9/10 - Train Loss: 0.1809, Train Acc: 0.9557, Val Loss: 0.8554, Val Acc: 0.8021
2025-07-01 15:58:06,689 - INFO - Fold 4, Epoch 10/10 - Train Loss: 0.1708, Train Acc: 0.9593, Val Loss: 0.8673, Val Acc: 0.7938
2025-07-01 15:58:52,771 - INFO - Fold 5, Epoch 1/10 - Train Loss: 1.4004, Train Acc: 0.4555, Val Loss: 0.9309, Val Acc: 0.7155
2025-07-01 15:59:37,784 - INFO - Fold 5, Epoch 2/10 - Train Loss: 0.7528, Train Acc: 0.7802, Val Loss: 0.6754, Val Acc: 0.7897
2025-07-01 16:00:22,803 - INFO - Fold 5, Epoch 3/10 - Train Loss: 0.5478, Train Acc: 0.8389, Val Loss: 0.6449, Val Acc: 0.7897
2025-07-01 16:01:07,854 - INFO - Fold 5, Epoch 4/10 - Train Loss: 0.4385, Train Acc: 0.8780, Val Loss: 0.6789, Val Acc: 0.7856
2025-07-01 16:01:52,900 - INFO - Fold 5, Epoch 5/10 - Train Loss: 0.3627, Train Acc: 0.9022, Val Loss: 0.6892, Val Acc: 0.7856
2025-07-01 16:02:37,941 - INFO - Fold 5, Epoch 6/10 - Train Loss: 0.2993, Train Acc: 0.9213, Val Loss: 0.7720, Val Acc: 0.7856
2025-07-01 16:03:22,856 - INFO - Fold 5, Epoch 7/10 - Train Loss: 0.2380, Train Acc: 0.9418, Val Loss: 0.8466, Val Acc: 0.7753
2025-07-01 16:04:07,803 - INFO - Fold 5, Epoch 8/10 - Train Loss: 0.2092, Train Acc: 0.9465, Val Loss: 0.8417, Val Acc: 0.7814
2025-07-01 16:04:52,788 - INFO - Fold 5, Epoch 9/10 - Train Loss: 0.1778, Train Acc: 0.9573, Val Loss: 0.8917, Val Acc: 0.7732
2025-07-01 16:05:37,757 - INFO - Fold 5, Epoch 10/10 - Train Loss: 0.1630, Train Acc: 0.9593, Val Loss: 0.8984, Val Acc: 0.7856
2025-07-01 16:05:39,779 - INFO - Final best model saved as PhoBERT_title_industry_v1.bin with accuracy 0.8148
2025-07-01 16:05:44,600 - INFO - 
=== DETAILED PER-CLASS EVALUATION METRICS ===
2025-07-01 16:05:44,601 - INFO - 
Per-class metrics:
+------------+-------------+----------+------------+-----------+
|            |   precision |   recall |   f1-score |   support |
+============+=============+==========+============+===========+
| Finance    |      0.8991 |   0.8099 |     0.8522 |  121.0000 |
+------------+-------------+----------+------------+-----------+
| Technology |      0.6917 |   0.7541 |     0.7216 |  122.0000 |
+------------+-------------+----------+------------+-----------+
| Healthcare |      0.8915 |   0.9504 |     0.9200 |  121.0000 |
+------------+-------------+----------+------------+-----------+
| Energy     |      0.6726 |   0.6230 |     0.6468 |  122.0000 |
+------------+-------------+----------+------------+-----------+
| Other      |      0.7561 |   0.7686 |     0.7623 |  121.0000 |
+------------+-------------+----------+------------+-----------+
2025-07-01 16:05:44,601 - INFO - 
=== COMPREHENSIVE OVERALL EVALUATION METRICS ===
2025-07-01 16:05:44,602 - INFO - 
Overall metrics:
+--------------------+---------+
|                    |   Value |
+====================+=========+
| Accuracy           |  0.7809 |
+--------------------+---------+
| Balanced Accuracy  |  0.7812 |
+--------------------+---------+
| Macro F1           |  0.7806 |
+--------------------+---------+
| Weighted F1        |  0.7803 |
+--------------------+---------+
| Macro Precision    |  0.7822 |
+--------------------+---------+
| Macro Recall       |  0.7812 |
+--------------------+---------+
| Cohen Kappa        |  0.7261 |
+--------------------+---------+
| Matthews Corr Coef |  0.7266 |
+--------------------+---------+
| Log Loss           |  0.8924 |
+--------------------+---------+
| Hamming Loss       |  0.2191 |
+--------------------+---------+
| Jaccard Score      |  0.6501 |
+--------------------+---------+
| ROC AUC            |  0.9333 |
+--------------------+---------+
| PR AUC             |  0.8124 |
+--------------------+---------+
| Top-2 Accuracy     |  0.9160 |
+--------------------+---------+
| Top-3 Accuracy     |  0.9555 |
+--------------------+---------+
2025-07-01 16:05:44,621 - INFO - Inference test: Text='Apple ra mắt iPhone 17 với chip A19 vào tháng 9.', Predicted='Technology'
