2025-07-16 11:05:52,766 - INFO - Logging initialized successfully
2025-07-16 11:05:52,978 - INFO - Adjusted BATCH_SIZE to 8 due to limited GPU memory
2025-07-16 11:05:58,775 - INFO - Original data loaded with shape: (12010, 9)
2025-07-16 11:06:02,947 - INFO - Removed 79 duplicate summaries
2025-07-16 11:06:02,951 - INFO - Removed 79 summaries shorter than 5 characters
2025-07-16 11:06:02,954 - INFO - Industry labels checked and stripped
2025-07-16 11:06:02,959 - INFO - Class distribution before balancing: {0: 4443, 1: 1348, 2: 757, 3: 1663, 4: 3720}
2025-07-16 11:06:02,959 - WARNING - Significant class imbalance detected!
2025-07-16 11:06:02,968 - INFO - Class distribution after balancing: {0: 757, 1: 757, 2: 757, 3: 757, 4: 757}
2025-07-16 11:06:08,971 - INFO - Tokenization completed with max_length=256
2025-07-16 11:06:10,441 - INFO - Saved processed data with shape: (3785, 4)
2025-07-16 11:06:10,445 - INFO - Summary length stats: Min=155, Max=959, Mean=507.79
2025-07-16 11:06:10,445 - INFO - Token length stats: Min=256, Max=256, Mean=256.00
2025-07-16 11:06:10,445 - INFO - Processing config: max_len=256, epochs=10, batch_size=16
2025-07-16 11:06:10,450 - INFO - Data split: Train+Val=3028, Test=757
2025-07-16 11:08:38,516 - INFO - Fold 1, Epoch 1/10 - Train Loss: 1.0956, Train Acc: 0.6338, Val Loss: 0.5637, Val Acc: 0.8201
2025-07-16 11:08:39,412 - INFO - Saved best model at fold 1, epoch 1 with accuracy 0.8201
2025-07-16 11:10:54,690 - INFO - Fold 1, Epoch 2/10 - Train Loss: 0.5012, Train Acc: 0.8522, Val Loss: 0.5007, Val Acc: 0.8234
2025-07-16 11:10:56,088 - INFO - Saved best model at fold 1, epoch 2 with accuracy 0.8234
2025-07-16 11:13:09,917 - INFO - Fold 1, Epoch 3/10 - Train Loss: 0.3453, Train Acc: 0.9009, Val Loss: 0.5082, Val Acc: 0.8350
2025-07-16 11:13:11,259 - INFO - Saved best model at fold 1, epoch 3 with accuracy 0.8350
2025-07-16 11:15:25,837 - INFO - Fold 1, Epoch 4/10 - Train Loss: 0.2671, Train Acc: 0.9253, Val Loss: 0.5738, Val Acc: 0.8350
2025-07-16 11:17:40,299 - INFO - Fold 1, Epoch 5/10 - Train Loss: 0.1845, Train Acc: 0.9538, Val Loss: 0.6349, Val Acc: 0.8449
2025-07-16 11:17:41,679 - INFO - Saved best model at fold 1, epoch 5 with accuracy 0.8449
2025-07-16 11:19:56,060 - INFO - Fold 1, Epoch 6/10 - Train Loss: 0.1399, Train Acc: 0.9657, Val Loss: 0.6911, Val Acc: 0.8432
2025-07-16 11:22:10,692 - INFO - Fold 1, Epoch 7/10 - Train Loss: 0.1153, Train Acc: 0.9748, Val Loss: 0.7666, Val Acc: 0.8383
2025-07-16 11:24:24,316 - INFO - Fold 1, Epoch 8/10 - Train Loss: 0.0794, Train Acc: 0.9814, Val Loss: 0.7959, Val Acc: 0.8449
2025-07-16 11:26:39,282 - INFO - Fold 1, Epoch 9/10 - Train Loss: 0.0626, Train Acc: 0.9864, Val Loss: 0.8139, Val Acc: 0.8482
2025-07-16 11:26:40,655 - INFO - Saved best model at fold 1, epoch 9 with accuracy 0.8482
2025-07-16 11:28:54,686 - INFO - Fold 1, Epoch 10/10 - Train Loss: 0.0544, Train Acc: 0.9889, Val Loss: 0.8211, Val Acc: 0.8449
2025-07-16 11:31:10,797 - INFO - Fold 2, Epoch 1/10 - Train Loss: 1.0418, Train Acc: 0.6569, Val Loss: 0.6103, Val Acc: 0.8020
2025-07-16 11:33:24,984 - INFO - Fold 2, Epoch 2/10 - Train Loss: 0.4829, Train Acc: 0.8518, Val Loss: 0.5302, Val Acc: 0.8267
2025-07-16 11:35:39,486 - INFO - Fold 2, Epoch 3/10 - Train Loss: 0.3386, Train Acc: 0.9050, Val Loss: 0.6024, Val Acc: 0.8185
2025-07-16 11:37:53,786 - INFO - Fold 2, Epoch 4/10 - Train Loss: 0.2519, Train Acc: 0.9294, Val Loss: 0.6088, Val Acc: 0.8251
2025-07-16 11:40:08,231 - INFO - Fold 2, Epoch 5/10 - Train Loss: 0.1807, Train Acc: 0.9529, Val Loss: 0.6280, Val Acc: 0.8465
2025-07-16 11:42:22,345 - INFO - Fold 2, Epoch 6/10 - Train Loss: 0.1485, Train Acc: 0.9604, Val Loss: 0.6572, Val Acc: 0.8317
2025-07-16 11:44:36,082 - INFO - Fold 2, Epoch 7/10 - Train Loss: 0.1099, Train Acc: 0.9761, Val Loss: 0.7127, Val Acc: 0.8416
2025-07-16 11:46:50,794 - INFO - Fold 2, Epoch 8/10 - Train Loss: 0.0901, Train Acc: 0.9814, Val Loss: 0.7508, Val Acc: 0.8432
2025-07-16 11:49:04,682 - INFO - Fold 2, Epoch 9/10 - Train Loss: 0.0638, Train Acc: 0.9868, Val Loss: 0.7703, Val Acc: 0.8350
2025-07-16 11:51:19,051 - INFO - Fold 2, Epoch 10/10 - Train Loss: 0.0589, Train Acc: 0.9880, Val Loss: 0.7660, Val Acc: 0.8399
2025-07-16 11:53:34,961 - INFO - Fold 3, Epoch 1/10 - Train Loss: 1.0287, Train Acc: 0.6602, Val Loss: 0.5887, Val Acc: 0.8284
2025-07-16 11:55:49,630 - INFO - Fold 3, Epoch 2/10 - Train Loss: 0.4903, Train Acc: 0.8530, Val Loss: 0.5313, Val Acc: 0.8300
2025-07-16 11:58:03,389 - INFO - Fold 3, Epoch 3/10 - Train Loss: 0.3579, Train Acc: 0.8910, Val Loss: 0.5123, Val Acc: 0.8399
2025-07-16 12:00:18,313 - INFO - Fold 3, Epoch 4/10 - Train Loss: 0.2668, Train Acc: 0.9249, Val Loss: 0.5634, Val Acc: 0.8300
2025-07-16 12:02:32,521 - INFO - Fold 3, Epoch 5/10 - Train Loss: 0.1992, Train Acc: 0.9480, Val Loss: 0.6470, Val Acc: 0.8284
2025-07-16 12:04:47,339 - INFO - Fold 3, Epoch 6/10 - Train Loss: 0.1544, Train Acc: 0.9604, Val Loss: 0.6488, Val Acc: 0.8416
2025-07-16 12:07:01,320 - INFO - Fold 3, Epoch 7/10 - Train Loss: 0.1190, Train Acc: 0.9711, Val Loss: 0.7231, Val Acc: 0.8300
2025-07-16 12:09:16,536 - INFO - Fold 3, Epoch 8/10 - Train Loss: 0.0906, Train Acc: 0.9789, Val Loss: 0.7606, Val Acc: 0.8317
2025-07-16 12:11:30,832 - INFO - Fold 3, Epoch 9/10 - Train Loss: 0.0726, Train Acc: 0.9831, Val Loss: 0.7663, Val Acc: 0.8317
2025-07-16 12:13:45,789 - INFO - Fold 3, Epoch 10/10 - Train Loss: 0.0658, Train Acc: 0.9860, Val Loss: 0.7775, Val Acc: 0.8300
2025-07-16 12:16:01,483 - INFO - Fold 4, Epoch 1/10 - Train Loss: 1.1773, Train Acc: 0.5774, Val Loss: 0.6723, Val Acc: 0.8033
2025-07-16 12:18:15,946 - INFO - Fold 4, Epoch 2/10 - Train Loss: 0.5253, Train Acc: 0.8489, Val Loss: 0.5203, Val Acc: 0.8298
2025-07-16 12:20:30,097 - INFO - Fold 4, Epoch 3/10 - Train Loss: 0.3758, Train Acc: 0.8894, Val Loss: 0.5265, Val Acc: 0.8281
2025-07-16 12:22:43,980 - INFO - Fold 4, Epoch 4/10 - Train Loss: 0.2862, Train Acc: 0.9179, Val Loss: 0.5594, Val Acc: 0.8347
2025-07-16 12:24:57,960 - INFO - Fold 4, Epoch 5/10 - Train Loss: 0.2043, Train Acc: 0.9447, Val Loss: 0.6320, Val Acc: 0.8380
2025-07-16 12:27:13,066 - INFO - Fold 4, Epoch 6/10 - Train Loss: 0.1554, Train Acc: 0.9604, Val Loss: 0.6927, Val Acc: 0.8331
2025-07-16 12:29:27,077 - INFO - Fold 4, Epoch 7/10 - Train Loss: 0.1137, Train Acc: 0.9748, Val Loss: 0.7516, Val Acc: 0.8298
2025-07-16 12:31:41,325 - INFO - Fold 4, Epoch 8/10 - Train Loss: 0.0947, Train Acc: 0.9790, Val Loss: 0.7993, Val Acc: 0.8281
2025-07-16 12:33:56,111 - INFO - Fold 4, Epoch 9/10 - Train Loss: 0.0752, Train Acc: 0.9843, Val Loss: 0.8062, Val Acc: 0.8298
2025-07-16 12:36:10,381 - INFO - Fold 4, Epoch 10/10 - Train Loss: 0.0654, Train Acc: 0.9876, Val Loss: 0.8188, Val Acc: 0.8314
2025-07-16 12:38:26,306 - INFO - Fold 5, Epoch 1/10 - Train Loss: 1.1471, Train Acc: 0.5951, Val Loss: 0.5873, Val Acc: 0.8314
2025-07-16 12:40:39,970 - INFO - Fold 5, Epoch 2/10 - Train Loss: 0.5244, Train Acc: 0.8473, Val Loss: 0.4771, Val Acc: 0.8479
2025-07-16 12:42:54,632 - INFO - Fold 5, Epoch 3/10 - Train Loss: 0.3639, Train Acc: 0.8902, Val Loss: 0.5070, Val Acc: 0.8231
2025-07-16 12:45:09,402 - INFO - Fold 5, Epoch 4/10 - Train Loss: 0.2611, Train Acc: 0.9336, Val Loss: 0.5357, Val Acc: 0.8496
2025-07-16 12:45:10,813 - INFO - Saved best model at fold 5, epoch 4 with accuracy 0.8496
2025-07-16 12:47:24,921 - INFO - Fold 5, Epoch 5/10 - Train Loss: 0.1936, Train Acc: 0.9521, Val Loss: 0.5797, Val Acc: 0.8380
2025-07-16 12:49:39,809 - INFO - Fold 5, Epoch 6/10 - Train Loss: 0.1452, Train Acc: 0.9645, Val Loss: 0.6453, Val Acc: 0.8364
2025-07-16 12:51:53,445 - INFO - Fold 5, Epoch 7/10 - Train Loss: 0.1100, Train Acc: 0.9765, Val Loss: 0.7234, Val Acc: 0.8248
2025-07-16 12:54:08,264 - INFO - Fold 5, Epoch 8/10 - Train Loss: 0.0797, Train Acc: 0.9835, Val Loss: 0.7460, Val Acc: 0.8281
2025-07-16 12:56:22,642 - INFO - Fold 5, Epoch 9/10 - Train Loss: 0.0639, Train Acc: 0.9876, Val Loss: 0.7712, Val Acc: 0.8298
2025-07-16 12:58:36,930 - INFO - Fold 5, Epoch 10/10 - Train Loss: 0.0580, Train Acc: 0.9876, Val Loss: 0.7764, Val Acc: 0.8264
2025-07-16 12:58:38,312 - INFO - Final best model saved as PhoBERT_summary_industry_v2.pth with accuracy 0.8496
2025-07-16 12:58:51,085 - INFO - 
=== DETAILED PER-CLASS EVALUATION METRICS ===
2025-07-16 12:58:51,086 - INFO - 
Per-class metrics:
+------------+-------------+----------+------------+-----------+
|            |   precision |   recall |   f1-score |   support |
+============+=============+==========+============+===========+
| Finance    |      0.8831 |   0.9007 |     0.8918 |  151.0000 |
+------------+-------------+----------+------------+-----------+
| Technology |      0.7602 |   0.8553 |     0.8050 |  152.0000 |
+------------+-------------+----------+------------+-----------+
| Healthcare |      0.9463 |   0.9338 |     0.9400 |  151.0000 |
+------------+-------------+----------+------------+-----------+
| Energy     |      0.7581 |   0.6184 |     0.6812 |  152.0000 |
+------------+-------------+----------+------------+-----------+
| Other      |      0.8302 |   0.8742 |     0.8516 |  151.0000 |
+------------+-------------+----------+------------+-----------+
2025-07-16 12:58:51,086 - INFO - 
=== COMPREHENSIVE OVERALL EVALUATION METRICS ===
2025-07-16 12:58:51,087 - INFO - 
Overall metrics:
+--------------------+---------+
|                    |   Value |
+====================+=========+
| Accuracy           |  0.8362 |
+--------------------+---------+
| Balanced Accuracy  |  0.8365 |
+--------------------+---------+
| Macro F1           |  0.8339 |
+--------------------+---------+
| Weighted F1        |  0.8337 |
+--------------------+---------+
| Macro Precision    |  0.8356 |
+--------------------+---------+
| Macro Recall       |  0.8365 |
+--------------------+---------+
| Cohen Kappa        |  0.7952 |
+--------------------+---------+
| Matthews Corr Coef |  0.7963 |
+--------------------+---------+
| Log Loss           |  0.5786 |
+--------------------+---------+
| Hamming Loss       |  0.1638 |
+--------------------+---------+
| Jaccard Score      |  0.7243 |
+--------------------+---------+
| ROC AUC            |  0.9618 |
+--------------------+---------+
| PR AUC             |  0.8941 |
+--------------------+---------+
| Top-2 Accuracy     |  0.9445 |
+--------------------+---------+
| Top-3 Accuracy     |  0.9815 |
+--------------------+---------+
2025-07-16 12:58:51,105 - INFO - Inference test: Text='Apple ra mắt iPhone 17 với chip A19 vào tháng 9.', Predicted='Technology'
