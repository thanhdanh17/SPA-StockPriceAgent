2025-07-20 03:06:52,249 - INFO - Logging initialized successfully
2025-07-20 03:07:01,157 - INFO - Original data loaded with shape: (12008, 3)
2025-07-20 03:07:02,064 - INFO - Removed 79 duplicate summaries
2025-07-20 03:07:02,069 - INFO - Removed 79 summaries shorter than 5 characters
2025-07-20 03:07:02,072 - INFO - Sentiment labels checked and stripped
2025-07-20 03:07:02,078 - INFO - Class distribution: {0: 5574, 1: 3173, 2: 3182}
2025-07-20 03:07:15,112 - INFO - Tokenization completed with max_length=256
2025-07-20 03:07:20,494 - INFO - Saved processed data with shape: (11929, 4)
2025-07-20 03:07:20,502 - INFO - Summary length stats: Min=98, Max=966, Mean=502.66
2025-07-20 03:07:20,503 - INFO - Token length stats: Min=256, Max=256, Mean=256.00
2025-07-20 03:07:20,503 - INFO - Processing config: max_len=256, n_splits=3
2025-07-20 03:07:20,512 - INFO - Data split: Train+Val=9543, Test=2386
2025-07-20 03:07:20,514 - INFO - Trial 0: lr=0.000040, batch_size=32, dropout_rate=0.32, epochs=12
2025-07-20 03:13:19,389 - INFO - Trial 0, Fold 1, Epoch 1/12 - Train Loss: 0.6913, Train Acc: 0.7076, Val Loss: 0.6365, Val Acc: 0.7664
2025-07-20 03:18:54,398 - INFO - Trial 0, Fold 1, Epoch 2/12 - Train Loss: 0.4781, Train Acc: 0.8054, Val Loss: 0.5081, Val Acc: 0.8079
2025-07-20 03:24:28,751 - INFO - Trial 0, Fold 1, Epoch 3/12 - Train Loss: 0.3189, Train Acc: 0.8763, Val Loss: 0.5824, Val Acc: 0.8120
2025-07-20 03:30:03,072 - INFO - Trial 0, Fold 1, Epoch 4/12 - Train Loss: 0.2112, Train Acc: 0.9227, Val Loss: 0.6506, Val Acc: 0.8123
2025-07-20 03:35:37,534 - INFO - Trial 0, Fold 1, Epoch 5/12 - Train Loss: 0.1402, Train Acc: 0.9552, Val Loss: 0.8128, Val Acc: 0.8082
2025-07-20 03:41:12,581 - INFO - Trial 0, Fold 1, Epoch 6/12 - Train Loss: 0.0879, Train Acc: 0.9725, Val Loss: 0.9596, Val Acc: 0.8082
2025-07-20 03:46:47,108 - INFO - Trial 0, Fold 1, Epoch 7/12 - Train Loss: 0.0596, Train Acc: 0.9830, Val Loss: 1.1906, Val Acc: 0.8051
2025-07-20 03:46:47,109 - INFO - Early stopping triggered at epoch 7 for fold 1
2025-07-20 03:52:23,148 - INFO - Trial 0, Fold 2, Epoch 1/12 - Train Loss: 0.7008, Train Acc: 0.6949, Val Loss: 0.5669, Val Acc: 0.7711
2025-07-20 03:57:57,577 - INFO - Trial 0, Fold 2, Epoch 2/12 - Train Loss: 0.5032, Train Acc: 0.8016, Val Loss: 0.5123, Val Acc: 0.7897
2025-07-20 04:03:32,133 - INFO - Trial 0, Fold 2, Epoch 3/12 - Train Loss: 0.3833, Train Acc: 0.8500, Val Loss: 0.5292, Val Acc: 0.7881
2025-07-20 04:09:06,843 - INFO - Trial 0, Fold 2, Epoch 4/12 - Train Loss: 0.2671, Train Acc: 0.9025, Val Loss: 0.6859, Val Acc: 0.8007
2025-07-20 04:14:41,782 - INFO - Trial 0, Fold 2, Epoch 5/12 - Train Loss: 0.1858, Train Acc: 0.9316, Val Loss: 0.6554, Val Acc: 0.7997
2025-07-20 04:20:16,708 - INFO - Trial 0, Fold 2, Epoch 6/12 - Train Loss: 0.1274, Train Acc: 0.9599, Val Loss: 0.8550, Val Acc: 0.8114
2025-07-20 04:25:51,424 - INFO - Trial 0, Fold 2, Epoch 7/12 - Train Loss: 0.0778, Train Acc: 0.9771, Val Loss: 0.9992, Val Acc: 0.8041
2025-07-20 04:31:25,977 - INFO - Trial 0, Fold 2, Epoch 8/12 - Train Loss: 0.0563, Train Acc: 0.9830, Val Loss: 1.0670, Val Acc: 0.7997
2025-07-20 04:37:00,148 - INFO - Trial 0, Fold 2, Epoch 9/12 - Train Loss: 0.0235, Train Acc: 0.9932, Val Loss: 1.2803, Val Acc: 0.8067
2025-07-20 04:37:00,150 - INFO - Early stopping triggered at epoch 9 for fold 2
2025-07-20 04:42:34,775 - INFO - Trial 0, Fold 3, Epoch 1/12 - Train Loss: 0.7246, Train Acc: 0.6793, Val Loss: 0.7370, Val Acc: 0.6410
2025-07-20 04:48:09,024 - INFO - Trial 0, Fold 3, Epoch 2/12 - Train Loss: 0.4734, Train Acc: 0.8071, Val Loss: 0.5106, Val Acc: 0.8045
2025-07-20 04:53:43,652 - INFO - Trial 0, Fold 3, Epoch 3/12 - Train Loss: 0.3246, Train Acc: 0.8783, Val Loss: 0.5408, Val Acc: 0.8051
2025-07-20 04:59:17,993 - INFO - Trial 0, Fold 3, Epoch 4/12 - Train Loss: 0.2145, Train Acc: 0.9219, Val Loss: 0.8508, Val Acc: 0.7913
2025-07-20 05:04:51,965 - INFO - Trial 0, Fold 3, Epoch 5/12 - Train Loss: 0.1424, Train Acc: 0.9539, Val Loss: 0.8027, Val Acc: 0.7960
2025-07-20 05:10:26,717 - INFO - Trial 0, Fold 3, Epoch 6/12 - Train Loss: 0.1005, Train Acc: 0.9698, Val Loss: 0.8860, Val Acc: 0.8086
2025-07-20 05:16:01,367 - INFO - Trial 0, Fold 3, Epoch 7/12 - Train Loss: 0.0698, Train Acc: 0.9816, Val Loss: 1.0356, Val Acc: 0.8064
2025-07-20 05:21:36,177 - INFO - Trial 0, Fold 3, Epoch 8/12 - Train Loss: 0.0470, Train Acc: 0.9874, Val Loss: 1.1365, Val Acc: 0.7957
2025-07-20 05:27:11,099 - INFO - Trial 0, Fold 3, Epoch 9/12 - Train Loss: 0.0290, Train Acc: 0.9947, Val Loss: 1.2727, Val Acc: 0.8073
2025-07-20 05:27:11,100 - INFO - Early stopping triggered at epoch 9 for fold 3
2025-07-20 05:27:11,100 - INFO - Trial 0 completed with average validation accuracy: 0.8108
2025-07-20 05:27:11,128 - INFO - Trial 1: lr=0.000043, batch_size=16, dropout_rate=0.23, epochs=9
2025-07-20 05:32:50,379 - INFO - Trial 1, Fold 1, Epoch 1/9 - Train Loss: 0.6771, Train Acc: 0.7150, Val Loss: 0.5540, Val Acc: 0.7872
2025-07-20 05:38:28,771 - INFO - Trial 1, Fold 1, Epoch 2/9 - Train Loss: 0.4520, Train Acc: 0.8180, Val Loss: 0.5227, Val Acc: 0.7935
2025-07-20 05:44:07,624 - INFO - Trial 1, Fold 1, Epoch 3/9 - Train Loss: 0.2891, Train Acc: 0.8889, Val Loss: 0.6244, Val Acc: 0.7982
2025-07-20 05:49:45,902 - INFO - Trial 1, Fold 1, Epoch 4/9 - Train Loss: 0.1898, Train Acc: 0.9425, Val Loss: 0.8689, Val Acc: 0.8076
2025-07-20 05:55:23,896 - INFO - Trial 1, Fold 1, Epoch 5/9 - Train Loss: 0.1046, Train Acc: 0.9689, Val Loss: 1.0934, Val Acc: 0.8060
2025-07-20 06:01:02,249 - INFO - Trial 1, Fold 1, Epoch 6/9 - Train Loss: 0.0522, Train Acc: 0.9865, Val Loss: 1.1785, Val Acc: 0.8095
2025-07-20 06:06:40,856 - INFO - Trial 1, Fold 1, Epoch 7/9 - Train Loss: 0.0278, Train Acc: 0.9928, Val Loss: 1.3354, Val Acc: 0.8126
2025-07-20 06:12:19,401 - INFO - Trial 1, Fold 1, Epoch 8/9 - Train Loss: 0.0106, Train Acc: 0.9975, Val Loss: 1.4005, Val Acc: 0.8164
2025-07-20 06:17:57,591 - INFO - Trial 1, Fold 1, Epoch 9/9 - Train Loss: 0.0088, Train Acc: 0.9978, Val Loss: 1.4372, Val Acc: 0.8152
2025-07-20 06:23:37,114 - INFO - Trial 1, Fold 2, Epoch 1/9 - Train Loss: 0.7373, Train Acc: 0.6724, Val Loss: 0.6199, Val Acc: 0.7699
2025-07-20 06:29:15,573 - INFO - Trial 1, Fold 2, Epoch 2/9 - Train Loss: 0.5113, Train Acc: 0.7986, Val Loss: 0.5230, Val Acc: 0.7749
2025-07-20 06:34:54,088 - INFO - Trial 1, Fold 2, Epoch 3/9 - Train Loss: 0.3631, Train Acc: 0.8677, Val Loss: 0.5343, Val Acc: 0.7966
2025-07-20 06:40:33,191 - INFO - Trial 1, Fold 2, Epoch 4/9 - Train Loss: 0.2533, Train Acc: 0.9157, Val Loss: 0.7844, Val Acc: 0.7997
2025-07-20 06:46:11,743 - INFO - Trial 1, Fold 2, Epoch 5/9 - Train Loss: 0.1711, Train Acc: 0.9521, Val Loss: 0.8888, Val Acc: 0.7979
2025-07-20 06:51:50,174 - INFO - Trial 1, Fold 2, Epoch 6/9 - Train Loss: 0.1275, Train Acc: 0.9675, Val Loss: 1.1698, Val Acc: 0.8035
2025-07-20 06:57:28,396 - INFO - Trial 1, Fold 2, Epoch 7/9 - Train Loss: 0.0743, Train Acc: 0.9843, Val Loss: 1.2153, Val Acc: 0.8070
2025-07-20 07:03:07,479 - INFO - Trial 1, Fold 2, Epoch 8/9 - Train Loss: 0.0400, Train Acc: 0.9917, Val Loss: 1.2627, Val Acc: 0.8041
2025-07-20 07:08:45,994 - INFO - Trial 1, Fold 2, Epoch 9/9 - Train Loss: 0.0195, Train Acc: 0.9961, Val Loss: 1.3422, Val Acc: 0.8035
2025-07-20 07:14:25,979 - INFO - Trial 1, Fold 3, Epoch 1/9 - Train Loss: 0.7180, Train Acc: 0.6903, Val Loss: 0.5753, Val Acc: 0.7724
2025-07-20 07:20:04,917 - INFO - Trial 1, Fold 3, Epoch 2/9 - Train Loss: 0.4578, Train Acc: 0.8191, Val Loss: 0.5251, Val Acc: 0.8016
2025-07-20 07:25:43,330 - INFO - Trial 1, Fold 3, Epoch 3/9 - Train Loss: 0.3096, Train Acc: 0.8823, Val Loss: 0.6646, Val Acc: 0.8007
2025-07-20 07:31:21,940 - INFO - Trial 1, Fold 3, Epoch 4/9 - Train Loss: 0.2129, Train Acc: 0.9327, Val Loss: 0.7504, Val Acc: 0.7931
2025-07-20 07:37:00,075 - INFO - Trial 1, Fold 3, Epoch 5/9 - Train Loss: 0.1309, Train Acc: 0.9648, Val Loss: 0.9509, Val Acc: 0.7988
2025-07-20 07:37:00,076 - INFO - Early stopping triggered at epoch 5 for fold 3
2025-07-20 07:37:00,077 - INFO - Trial 1 completed with average validation accuracy: 0.8083
2025-07-20 07:37:00,119 - INFO - Trial 2: lr=0.000020, batch_size=16, dropout_rate=0.41, epochs=6
2025-07-20 07:42:39,177 - INFO - Trial 2, Fold 1, Epoch 1/6 - Train Loss: 0.7074, Train Acc: 0.7021, Val Loss: 0.5696, Val Acc: 0.7554
2025-07-20 07:48:17,956 - INFO - Trial 2, Fold 1, Epoch 2/6 - Train Loss: 0.4762, Train Acc: 0.8123, Val Loss: 0.5204, Val Acc: 0.7997
2025-07-20 07:53:56,787 - INFO - Trial 2, Fold 1, Epoch 3/6 - Train Loss: 0.3355, Train Acc: 0.8739, Val Loss: 0.5287, Val Acc: 0.8104
2025-07-20 07:59:35,159 - INFO - Trial 2, Fold 1, Epoch 4/6 - Train Loss: 0.2329, Train Acc: 0.9213, Val Loss: 0.6107, Val Acc: 0.8133
2025-07-20 08:05:13,779 - INFO - Trial 2, Fold 1, Epoch 5/6 - Train Loss: 0.1643, Train Acc: 0.9502, Val Loss: 0.7741, Val Acc: 0.8126
2025-07-20 08:10:52,477 - INFO - Trial 2, Fold 1, Epoch 6/6 - Train Loss: 0.1059, Train Acc: 0.9693, Val Loss: 0.8464, Val Acc: 0.8142
2025-07-20 08:16:31,830 - INFO - Trial 2, Fold 2, Epoch 1/6 - Train Loss: 0.7324, Train Acc: 0.6745, Val Loss: 0.6028, Val Acc: 0.7809
2025-07-20 08:22:10,562 - INFO - Trial 2, Fold 2, Epoch 2/6 - Train Loss: 0.4860, Train Acc: 0.8101, Val Loss: 0.5294, Val Acc: 0.8032
2025-07-20 08:27:49,012 - INFO - Trial 2, Fold 2, Epoch 3/6 - Train Loss: 0.3553, Train Acc: 0.8678, Val Loss: 0.5906, Val Acc: 0.7831
2025-07-20 08:33:27,016 - INFO - Trial 2, Fold 2, Epoch 4/6 - Train Loss: 0.2713, Train Acc: 0.9069, Val Loss: 0.5963, Val Acc: 0.7988
2025-07-20 08:39:05,361 - INFO - Trial 2, Fold 2, Epoch 5/6 - Train Loss: 0.2011, Train Acc: 0.9378, Val Loss: 0.7042, Val Acc: 0.8117
2025-07-20 08:44:43,932 - INFO - Trial 2, Fold 2, Epoch 6/6 - Train Loss: 0.1491, Train Acc: 0.9563, Val Loss: 0.7859, Val Acc: 0.8101
2025-07-20 08:50:23,484 - INFO - Trial 2, Fold 3, Epoch 1/6 - Train Loss: 0.6820, Train Acc: 0.7109, Val Loss: 0.5172, Val Acc: 0.7853
2025-07-20 08:56:01,944 - INFO - Trial 2, Fold 3, Epoch 2/6 - Train Loss: 0.4529, Train Acc: 0.8216, Val Loss: 0.5145, Val Acc: 0.7784
2025-07-20 09:01:40,793 - INFO - Trial 2, Fold 3, Epoch 3/6 - Train Loss: 0.3197, Train Acc: 0.8860, Val Loss: 0.5806, Val Acc: 0.8023
2025-07-20 09:07:19,602 - INFO - Trial 2, Fold 3, Epoch 4/6 - Train Loss: 0.2296, Train Acc: 0.9202, Val Loss: 0.6874, Val Acc: 0.8041
2025-07-20 09:12:58,459 - INFO - Trial 2, Fold 3, Epoch 5/6 - Train Loss: 0.1567, Train Acc: 0.9525, Val Loss: 0.7882, Val Acc: 0.7997
2025-07-20 09:18:37,033 - INFO - Trial 2, Fold 3, Epoch 6/6 - Train Loss: 0.1007, Train Acc: 0.9689, Val Loss: 0.8793, Val Acc: 0.8108
2025-07-20 09:18:37,034 - INFO - Trial 2 completed with average validation accuracy: 0.8122
2025-07-20 09:18:37,063 - INFO - Best trial: 2
2025-07-20 09:18:37,063 - INFO - Best validation accuracy: 0.8122
2025-07-20 09:18:37,063 - INFO - Best hyperparameters: {'learning_rate': 2.0317725126468357e-05, 'batch_size': 16, 'dropout_rate': 0.40864433439381564, 'n_epochs': 6}
2025-07-20 09:18:37,063 - INFO - Training final model with best hyperparameters: lr=0.000020, batch_size=16, dropout_rate=0.41, epochs=6
2025-07-20 09:24:16,207 - INFO - Final Training, Fold 1, Epoch 1/6 - Train Loss: 0.6832, Train Acc: 0.7161, Val Loss: 0.5078, Val Acc: 0.8048
2025-07-20 09:24:16,987 - INFO - Saved best model at fold 1, epoch 1 with accuracy 0.8048
2025-07-20 09:29:56,312 - INFO - Final Training, Fold 1, Epoch 2/6 - Train Loss: 0.4420, Train Acc: 0.8265, Val Loss: 0.4999, Val Acc: 0.8104
2025-07-20 09:29:57,780 - INFO - Saved best model at fold 1, epoch 2 with accuracy 0.8104
2025-07-20 09:35:36,464 - INFO - Final Training, Fold 1, Epoch 3/6 - Train Loss: 0.3085, Train Acc: 0.8873, Val Loss: 0.5682, Val Acc: 0.8073
2025-07-20 09:41:14,657 - INFO - Final Training, Fold 1, Epoch 4/6 - Train Loss: 0.2168, Train Acc: 0.9246, Val Loss: 0.6370, Val Acc: 0.8098
2025-07-20 09:46:53,728 - INFO - Final Training, Fold 1, Epoch 5/6 - Train Loss: 0.1489, Train Acc: 0.9536, Val Loss: 0.7480, Val Acc: 0.8186
2025-07-20 09:46:55,078 - INFO - Saved best model at fold 1, epoch 5 with accuracy 0.8186
2025-07-20 09:52:33,848 - INFO - Final Training, Fold 1, Epoch 6/6 - Train Loss: 0.1053, Train Acc: 0.9670, Val Loss: 0.8313, Val Acc: 0.8155
2025-07-20 09:58:13,366 - INFO - Final Training, Fold 2, Epoch 1/6 - Train Loss: 0.7154, Train Acc: 0.6968, Val Loss: 0.5678, Val Acc: 0.7586
2025-07-20 10:03:51,801 - INFO - Final Training, Fold 2, Epoch 2/6 - Train Loss: 0.4826, Train Acc: 0.8068, Val Loss: 0.5492, Val Acc: 0.7988
2025-07-20 10:09:30,128 - INFO - Final Training, Fold 2, Epoch 3/6 - Train Loss: 0.3510, Train Acc: 0.8691, Val Loss: 0.5538, Val Acc: 0.7928
2025-07-20 10:15:08,152 - INFO - Final Training, Fold 2, Epoch 4/6 - Train Loss: 0.2484, Train Acc: 0.9102, Val Loss: 0.6405, Val Acc: 0.8067
2025-07-20 10:20:46,470 - INFO - Final Training, Fold 2, Epoch 5/6 - Train Loss: 0.1700, Train Acc: 0.9478, Val Loss: 0.8247, Val Acc: 0.8010
2025-07-20 10:26:24,387 - INFO - Final Training, Fold 2, Epoch 6/6 - Train Loss: 0.1159, Train Acc: 0.9667, Val Loss: 0.8841, Val Acc: 0.8023
2025-07-20 10:32:04,203 - INFO - Final Training, Fold 3, Epoch 1/6 - Train Loss: 0.6855, Train Acc: 0.7102, Val Loss: 0.5318, Val Acc: 0.7891
2025-07-20 10:37:43,128 - INFO - Final Training, Fold 3, Epoch 2/6 - Train Loss: 0.4633, Train Acc: 0.8177, Val Loss: 0.5377, Val Acc: 0.7985
2025-07-20 10:43:22,273 - INFO - Final Training, Fold 3, Epoch 3/6 - Train Loss: 0.3199, Train Acc: 0.8796, Val Loss: 0.5582, Val Acc: 0.7916
2025-07-20 10:49:01,035 - INFO - Final Training, Fold 3, Epoch 4/6 - Train Loss: 0.2122, Train Acc: 0.9305, Val Loss: 0.7821, Val Acc: 0.8054
2025-07-20 10:54:40,135 - INFO - Final Training, Fold 3, Epoch 5/6 - Train Loss: 0.1314, Train Acc: 0.9615, Val Loss: 0.9401, Val Acc: 0.8089
2025-07-20 11:00:18,800 - INFO - Final Training, Fold 3, Epoch 6/6 - Train Loss: 0.0906, Train Acc: 0.9741, Val Loss: 0.9253, Val Acc: 0.8120
2025-07-20 11:00:20,206 - INFO - Final best model saved as PhoBERT_summary_sentiment_optuna.bin with accuracy 0.8186
2025-07-20 11:00:53,856 - INFO - 
=== DETAILED PER-CLASS EVALUATION METRICS ===
2025-07-20 11:00:53,857 - INFO - 
Per-class metrics:
+----------+-------------+----------+------------+-----------+
|          |   precision |   recall |   f1-score |   support |
+==========+=============+==========+============+===========+
| Positive |      0.8705 |   0.8787 |     0.8746 |  635.0000 |
+----------+-------------+----------+------------+-----------+
| Negative |      0.7008 |   0.6997 |     0.7002 |  636.0000 |
+----------+-------------+----------+------------+-----------+
| Neutral  |      0.8919 |   0.8879 |     0.8899 | 1115.0000 |
+----------+-------------+----------+------------+-----------+
2025-07-20 11:00:53,857 - INFO - 
=== COMPREHENSIVE OVERALL EVALUATION METRICS ===
2025-07-20 11:00:53,858 - INFO - 
Overall metrics:
+--------------------+---------+
|                    |   Value |
+====================+=========+
| Accuracy           |  0.8353 |
+--------------------+---------+
| Balanced Accuracy  |  0.8221 |
+--------------------+---------+
| Macro F1           |  0.8216 |
+--------------------+---------+
| Weighted F1        |  0.8353 |
+--------------------+---------+
| Macro Precision    |  0.8211 |
+--------------------+---------+
| Macro Recall       |  0.8221 |
+--------------------+---------+
| Cohen Kappa        |  0.7427 |
+--------------------+---------+
| Matthews Corr Coef |  0.7427 |
+--------------------+---------+
| Log Loss           |  0.6318 |
+--------------------+---------+
| Hamming Loss       |  0.1647 |
+--------------------+---------+
| Jaccard Score      |  0.7250 |
+--------------------+---------+
| ROC AUC            |  0.9436 |
+--------------------+---------+
| PR AUC             |  0.8722 |
+--------------------+---------+
| Top-2 Accuracy     |  0.9807 |
+--------------------+---------+
| Top-3 Accuracy     |  1.0000 |
+--------------------+---------+

